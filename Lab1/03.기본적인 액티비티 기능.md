# 기본적인 액티비티 기능

##  1. 변수, 인수 이해 및 활용

### 변수의 기본 개념

▪ 변수(Variable)는 정보를 저장할 수 있는 공간의 이름을 뜻하는 용어로 프로그래밍의 중요한 개념입니다. 즉, 다양한 유형의 데이터를 저장하는 
상자라고 말할 수 있는데 여기에 텍스트, 숫자, 날짜, 리스트등의 다양한 데이터를 저장할 수 있습니다. 변수는 특정한 값이나 데이터를 
일시적으로 저장하여 필요할 때마다 꺼내어 사용할 수 있게 해줍니다. 이처럼 변수를 사용하면 복잡한 데이터를 간편하게 처리하고, 
코드의 가독성을 높이며, 작업의 효율성을 크게 향상시킬 수 있습니다. 

▪ 변수를 통해 사용자가 입력한데이터, 계산결과, 웹스크래핑 데이터등 다양한 정보를 저장하고 이를 바탕으로 여러작업을 자동화할 수 
있습니다. 변수를 적절히 활용하면 반복적인 작업을 줄이고, 조건에 따라 동적으로 데이터를 처리할 수 있습니다.

### 변수의 유형

![image](https://github.com/user-attachments/assets/9bc58c04-2dbc-41f3-86a0-b31336d22c77)

### 변수를 사용할 때 주의사항

▪ 변수 유형에 맞지 않는 데이터를 할당하면 오류가 발생합니다. 예를 들어, 숫자 유형의 변수에 텍스트를 넣는것은 허용되지 
않습니다. 또한 정수형 변수(Integer)는 계산할 때 사용할 수 있지만 문자열 변수(String)은 계산할 때 사용할 수 없습니다. 그래서 
필요에 따라 변수의 유형을 변환하여 사용합니다.

### 변수 활용하기

▪ UiPath에서 변수는 중요한 역할을 합니다. 여러 작업간에 데이터를 전달하거나, 특정 작업의 결과를 저장하거나, 조건에 따라 다른 
작업을 수행하는 등 다양한 목적으로 변수를 사용합니다.

▪ 변수에 대한 이해는U iPath RPA를 효율적으로개 발하는데 필수적입니다. 어떤 값이 여러 작업에서 반복적으로 사용되거나 변경되어야 
하는 경우에 값을 변수에 저장하면 효율적인 작업 수행이 가능합니다.

![image](https://github.com/user-attachments/assets/a0f06a14-aa5c-41c7-aa82-abb37b884f22)

### 변수를 사용해야 하는 이유

▪ 변수는 프로그래밍의 중요한 요소로 작업을 자동화하고, 작업의 흐름을 유연하게 관리하고, 코드의 가독성을 높이며,코드를 효율적으로 
유지 관리하기 위해서 필수적으로 사용합니다.  


### 인수의 기본 개념

▪ 인수(Argument)는 워크플로 간에 데이터를 전달하는데 사용되는 중요한 개념입니다. 인수는 프로그래밍에서 함수나 메서드에 
전달하는 파라미터와 비슷한 역할을 합니다. 이를 통해 자동화 프로세스의 여러 부분 간에 데이터를 주고 받을수 있으며, 워크플로의 
재사용성을 높이는데 중요한 역할을 합니다.

### 인수의 종류

▪ In(입력인수): 외부에서 워크플로 데이터를 전달할 때 사용됩니다. 워크플로 내부에서는 이데이터를 읽기만 할 수 있습니다.
예를 들어, 고객의 이름을 처리하는 워크플로에 고객 이름을 전달하는 경우, 이 이름은 입력 인수로 설정될 수 있습니다.

▪ Out(출력인수): 워크플로에서 외부로 데이터를 전달할 때사용됩니다. 워크플로 내에서 데이터가 처리된 후, 그 결과를 상위 
워크플로나 호출한 워크플로로 반환할 때 사용됩니다. 예를 들어, 계산 결과를 다른 워크플로에 전달하려는 경우, 이 결과를 출력 
인수로 설정할 수 있습니다.

▪ In/Out(입력및출력인수): 데이터를 워크플로에 전달하고, 그 데이터를 수정하거나 가공한 후 다시 외부로 반환할 때사용됩니다. 
예를 들어, 특정 값이 워크플로에 전달된 후, 그 값이 변경되어 다시 외부로 반환되는 경우, 이 인수를 사용할 수 있습니다.

### 인수의 유형

▪ UiPath Studio는 변수의 유형과 일치하는 다양한 유형의 인수를 지원합니다. 
    즉, Generic Value, String, Boolean, Object, Array, DataTable 인수를 생성할 수 있고 다양한 .Net 유형도 지원합니다. 
    
▪ 주의해야 할 점은 같은 이름의 변수와 인수가 모두있는 경우 변수가 항상 기본값으로 사용되며 런타임에 사용된다는 것입니다.
   
▪ 인수는 Orchestrator API 또는 인터페이스를 통해 입력을 받거나 출력을 반환할 때 사용하기도 합니다

### 인수 사용해보기 

▪ 인수를 생성하는 방법은 여러가지가 있습니다. 'Data Manager'를 사용하여 새인수를 생성할 수 있는데 이때 이름, 방향, 데이터유형, 필수
여부, 기본값 등을 설정할 수 있습니다. 액티비티의 본문이나 속성 패널에서 인수를 생성하기도 합니다.또한, 인수패널(Arguments Panel)에서도 
인수를 생성할 수 있습니다.

▪ 인수의 이름은 방향접두사와 함께 CamelCase(단어의 첫 글자를 대문자로 작성)로 지정하는 방법이 주로 사용되고 있습니다. 예를 들어, 
'in_DefaultTimeout', 'in_FileName', 'out_TextResult', 'io_RetryNumber' 등 입니다.

![image](https://github.com/user-attachments/assets/3fb36b8a-4e5c-4891-b2b2-370dbb644184)

- 인수 패널에서 인수 생성

![image](https://github.com/user-attachments/assets/1d7896e7-cc76-4e4e-a5f2-e5f2a138f039)

- 데이터 관리자 패널에서 인수 생성

##  2. 워크플로 작성에 활용되는 기본적인 액티비티

### 1) 조건문과 반복문

#### 조건문의 개념

  ▪ 조건문은 워크플로를 다양한 상황에 따라 다르게 동작하도록 구현할 때 사용합니다.
  
  ▪ 조건문은 "만약(조건)이면, (A)를하고, 그렇지 않으면(B)를 한다"와 같은 구조로 이해할 수 있습니다. 예를 들어, "만약 비가 오면, 
우산을 들고 나가고, 그렇지 않으면 그냥 나간다"와 같은 상황을 생각해 보세요. 여기서 "비가 오는지"가 조건이고 이 조건에 따라 
행동이 달라집니다. 이렇게 조건에 따라 다른 실행을 하는 기능을 조건 분기라고 합니다. 조건 분기는 여러개의 조건이 있을때도 
사용할 수 있습니다. 예를 들어, ＂날씨가 맑으면 산책을 하고, 비가 오면 영화를 보고, 눈이 오면 눈싸움을 한다＂와 같은 상황을 
생각해 보세요. 여기서＂날씨 상태＂를 조건으로 하여 각기 다른 행동을 결정합니다.

 ▪ 조건문에 많이 사용하는 액티비티에는 If, Else If, Flow Decision 등이 있습니다. 

#### 조건문

▪ UiPath에서 조건문을 구현할 때 가장 많이 사용하는 액티비티로 If 액티비티를 꼽을 수 있습니다. If 액티비티는 다음과 같이 세 가지 
주요 구성 요소로 구성되어 있습니다.

 - 조건(Condition)
    이 부분은 Boolean 값, 즉 참(True) 또는 거짓(False)으로 나올 수 있는 조건을 입력합니다. 
 - Then 분기
    이 부분에 조건이 참(True)인 경우에 수행되는 액티비티가 배치됩니다. 
 - Else 분기
    이 부분에는 조건이 거짓(False)인 경우에 수행되는 액티비티가 배치됩니다.

![image](https://github.com/user-attachments/assets/3676d941-e73c-4b88-92be-11468311fce2)

#### 조건문 사용 시 주의사항

▪ 조건문은 프로그래밍의 기본적인 구조중 하나로, 특정 조건에 따라 다른 작업을 수행하도록 하는 역할을 합니다. UiPath에서는 
이러한 조건문의 역할을 수행하는 '조건 액티비티'를 제공하며, 이를 통해 특정 조건에 따라 다른 작업을 수행하는 로직을 구성할 수 
있습니다. 이때, 복잡하고 많은 조건문을 많이 사용하면 프로세스가 복잡해질 수 있으므로 최소한의 조건문만 사용하는 것이 좋습니다.

#### 비교연산자

 ▪ 비교 연산자는 두 값이나 변수를 비교할 때 사용하는데 그 결과는 참(True) 또는 거짓(False)입니다. 주로 사용되는 비교연산자는 
다음과 같습니다.

![image](https://github.com/user-attachments/assets/dd0b50f8-7313-4de9-8c80-108ddd5c1603)

#### 논리연산자

▪ 논리 연산자는 주로 Boolean(참또 는 거짓) 값을 비교하거나 조합하는데 사용되고 주로 사용되는 논리 연산자는 다음과 같습니다.

![image](https://github.com/user-attachments/assets/331bcbe7-0210-456e-a74b-08ef4fa347c6)


#### 선택문의 개념

▪ 선택문은 프로그래밍에서 특정 조건에 따라 다른 코드 블록을 실행할 때사용되는 구조입니다. 선택문은 일치하는 경우의 값이 있을
경우에만 실행문을 실행시키는 Switch 액티비티를 뜻합니다. 이러한 선택문은 사용자의 입력이나 특정 결과에 따라 다른 작업을 
수행시킬 때 유용하게 사용됩니다. 

#### 선택문

▪ UiPath에서는 'Switch', 'Flow Switch'과 같은 여러가지 선택문 액티비티를 제공합니다. 'Switch' 액티비티는 여러경우 중 하나를 
선택하여 실행하는 선택문입니다. 'Switch' 액티비티의 'Expression' 속성에는 평가할 식을 입력하고, 'Cases' 속성에는 가능한 
결과값과 해당값이 나왔을때 실행할 작업을 지정합니다. 예를 들어, 'Expression'에 "변수mod 2"라는 식을 입력하면, 이식의 
결과값(즉, 변수를 2로 나눈 나머지)에 따라 다른 작업을 수행하게됩니다.

▪ 'Switch' 액티비티를 사용하면 다양한 결과에 따라 다른 작업을 효율적으로 수행할 수 있습니다. 이렇게 선택문을 사용하면 코드의 
가독성을 높이고 액티비티의 개수를 줄일 수 있어프 로세스 를효율적으로 관리할 수 있습니다.

![image](https://github.com/user-attachments/assets/5470b8fe-a709-4140-9f59-a7c5329a728d)


#### 반복문의 개념

▪반복문은 프로그래밍의 핵심요소로 일련의 작업을 빠르고 반복적으로 수행하기 위해 사용됩니다. 이를 통해 동일한 코드를 여러번 
실행시켜서 규칙적인 패턴을 가진 작업을 용이하게 처리할 수 있습니다. 반복문이란 특정 조건이 만족되는 동안 명령을 계속 실행하는 
구조입니다. 예를 들어 엑셀의 모든데이터를 순차적으로 처리하거나 이메일을 하나씩 읽어서 첨부파일이 있으면 다운로드하는 등의 
작업을 구현할 수 있습니다.

#### 반복문

▪ UiPath에서는 여러가지 반복문 액티비티를 제공합니다.

   - While 액티비티는 주어진 조건이 참인 경우 작업을 반복합니다.
     
   - Do While 액티비티는 주어진 조건이 참인 경우 작업을 반복한다는 점에서 While과 같지만 무조건 한번 실행한 후 조건을 
     판단한다는 점에서 차이가 있습니다.
     
   - For Each 액티비티는 배열이나 컬렉션의 각 요소에 대해 액티비티를 반복합니다. 예를 들어 Array_Test라는 변수에 
     {“FDX”,”NET”,”Works”} 데이터가 있다면 For Each를 통해 배열의 개수만큼(3개) 반복하여 출력할 수 있습니다. 
     출력할 때는 item명을 적어주면 됩니다. For Each는 Enumerable.Range와 같이 범위를 지정하여 반복하기도 합니다.
     Enumerable.Range(시작값,반복횟수)
     Repeat Number Of Times 액티비티는 주어진 횟수 만큼 액티비티를 반복합니다.

![image](https://github.com/user-attachments/assets/6ac12943-45e6-406b-a003-37571f32debb) ![image](https://github.com/user-attachments/assets/eedc5fe8-b257-4f85-94b7-874171d1e861)

![image](https://github.com/user-attachments/assets/b5c0c85b-64d4-4ef7-a745-42913490622d)

#### 반복문 사용 시 주의사항

▪ 반복문을 사용할때 주의할 점이 몇 가지 있습니다. 무한 루프에 빠지지 않도록 반복문의 종료조건을 명확히 설정해야 합니다. 또한 반복 
작업중에 예외가 발생할 수 있으므로 예외 처리 방법을 알고 있어야 합니다.

### 데이터테이블에서 반복문 사용하기

▪ For Each Row In DataTable 액티비티를 사용하면 데이터테이블의 각 행에 대해 작업을 반복할 수 있습니다. 이 액티비티는 Excel 
에서 읽은 데이터를 처리할 때 많이 사용합니다. 

▪ For Each Row in DataTable 을 통해 반복문을 이용하면 CurrentRow("열이름") 또는 CurrentRow(열번호)로 데이터를 가져올 수 
있습니다. 반면 반복문을 사용하지 않고 데이터테이블에서 데이터를 가져올 수도 있는데
데이터테이블 변수명.Rows(행번호).Item(열번호).ToString 또는 데이터테이블 변수명.Rows(행번호).Item("열이름").ToString을
통해 특정한 위치의값(행렬값)을 가져올 수 있습니다.

▪ 이렇게 반복문을 사용하여 지정된 횟수나 존재하는 개수 만큼 반복하거나 특정 조건을 만족할때까지 실행할 수 있습니다. 이를 통해 
RPA의 성능을 극대화할 수 있습니다.

![image](https://github.com/user-attachments/assets/32851dd7-255b-4a88-8fb2-8af6cbbdaef7) ![image](https://github.com/user-attachments/assets/a866013c-53a4-43d2-8bfa-9ed015470b89)

### 2) 문자열 메스드(함수)

#### 문자열 메소드

▪ 문자열메소드란 문자열 데이터를 조작하거나 정보를 가져오는데 사용되는 기능을 말합니다. 문자열은 많은 프로그래밍언어에서 기본 
데이터유형 중 하나로, 이에 따라 다양한 문자열 메소드들이 제공됩니다.

 ▪ UiPath에서도 프로그래밍언어에서 일반적으로 사용하는 여러 문자열메소드를 사용할 수 있습니다. 이러한 메소드들은 문자열을 
조작하는데 도움이됩니다.

#### 형변환 (Type Conversion)

 ▪ 형변환(Type Conversion) 또는 타입 캐스팅(Type Casting)이란, 한 데이터 유형을 다른 데이터 유형으로 변환하는 것을 말합니다. 
프로그래밍 언어에서는 변수의 데이터 유형을 변환할 수 있는 기능을 제공합니다.

 ▪ 예를 들어 String 유형의 데이터를 Int 유형으로 변환하거나 Int 유형의 데이터를 String 유형으로 변환할 수 있습니다. String 유형에서 
더하기 연산을 사용하면 문자가 합쳐지기 때문에 계산이 필요한 경우에는 Int 유형으로 바꿔서 더하기 연산을 사용합니다. 

▪ A 변수에는 150이라는 데이터를, B 변수에는 250이라는 데이터를 넣겠습니다. A+B라는 식이 있다고 가정했을 때 A 변수와 B 변수가
모두 String 유형이라면 결과값은 “150250”이 됩니다. 반면 A 변수와 B 변수가 모두 Int 유형이라면 결과값은 “400”이 나옵니다.

▪ 연산을 할 때 변수 유형이 다르다면 오류가 발생하여 연산이 불가능합니다.

![image](https://github.com/user-attachments/assets/c6ae0293-b954-4a9c-83f0-ad34d111e659)

### UiPath에서사용하는대표적인 문자열 메소드

▪ UiPath에서는 VB.net Method를 활용하여 다양하게 데이터를 가공할 수 있습니다. 아래 메소드 말고도 다양한 메소드들이 있으니
검색하여 활용하시기 바랍니다.

▪ 실행 했을때 System.String[]과 같은 출력값이 나온다면 메소드를 잘못 처리한 것입니다.

![image](https://github.com/user-attachments/assets/e61da9d3-c578-48b7-a8e1-d26ed0af90fb)

### UiPath에서 사용하는 참고 문자열 메소드

![image](https://github.com/user-attachments/assets/0a71b309-ff73-47ca-953a-dca3c34558fd)

### 절대경로와 상대경로의 이해

▪ 시스템에서경로는매우중요한개념입니다. 경로는컴퓨터내에서특정파일이나디렉토리의위치를의미합니다. RPA에서는데이터
관리와프로젝트유지보수를위해경로의개념을정확히이해하고활용해야합니다.
 + 파일시스템과경로
파일시스템에서‘경로(Path)'는특정파일또는폴더의위치를나타내는문자열입니다. 이경로는일반적으로'절대경로(Absolute 
Path)’와'상대경로(Relative Path)’로구분할수있습니다.
 + 절대경로vs 상대경로
 - 절대경로 : 파일시스템의루트디렉토리부터시작하여특정파일또는디렉토리까지의전체경로를나타냅니다. 이경로는파일
  시스템의구조에따라항상동일하고 파일의위치를명확하게표시합니다. - 상대경로 :현재디렉토리를기준으로특정파일또는디렉토리의위치를나타냅니다. 이경로는현재위치에따라달라질수있습니다.
    상대경로는특히파일시스템의일부만이동하거나복사할때유용합니다.
 +  RPA에서의절대경로와상대경로
▪RPA 개발에서는일반적으로상대경로를사용하는것이좋습니다. 왜냐하면, 절대경로는개발PC의파일시스템구조에의존하기
때문에RPA 로봇이다른PC에서실행될경우절대경로가더이상유효하지않을수있기때문입니다. 이렇게경로를찾지못하면
로봇이데이터를가져오지못해서 프로세스가실패하게됩니다.
 ▪따라서 RPA 개발에서는상대경로를사용하거나별도의설정파일(Config File)을만들어경로값을관리하는것이좋습니다. 
이렇게하면로봇이실행되는PC의파일시스템구조에관계없이작업을수행할수있습니다.
 ▪개발프로젝트에서는일반적으로Data 폴더를만들고그안에Output, Input, Temp 등의하위폴더를만들어데이터와산출물을
관리합니다. 이런구조를유지하면서상대경로를활용하면 RPA 로봇은어느PC에서든원활하게작업을수행할수있습니다.













 ##  3. 간단한 프로세스 만들기

 ### 인수 사용해보기

![image](https://github.com/user-attachments/assets/5351d083-637d-45c4-bd72-27f8feb50b27)

![image](https://github.com/user-attachments/assets/854f545c-b93a-45e6-81fc-46be2f607aaa)

▪ 이와 같이 진행하고 시퀀스1을 실행하면 워크플로우A에서 입력했던 “홍길동” 이라는 변수값이 워크플로우B에서 출력되는 것을 볼 수 있습니다. 

▪ 이와 같이 워크플로 단위에서 데이터 이동이 필요할 때 인수를 사용할 수 있습니다.

![image](https://github.com/user-attachments/assets/a6fce6ce-a7b0-4149-b164-2f343bd9017b)












 
